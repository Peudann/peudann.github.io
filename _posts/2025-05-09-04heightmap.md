---
title: "25.05.09 / HeightMap의 사이즈가 '2의 제곱수 + 1'인 이유"
excerpt: ""

categories:
  - Programming
  - Game Development
tags:
  - []

toc: true
toc_sticky: true
use_math: true

date: 2025-05-09
last_modified_at: 2025-05-13
---

<div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
  <img src="/assets/img/250509_04heightmap/01.png" alt="01" style="max-width: 100%;" />
</div>

<div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
  <img src="/assets/img/250509_04heightmap/02.png" alt="02" style="max-width: 100%;" />
</div>

Unity 및 많은 게임 엔진에서는 지형(Heightmap) 해상도를 보통 $ 2^{n} + 1 $ 형태(257x257, 513x513 등)로 쓰는데, 이는 **내부적으로 지형을 2의 제곱 단위로 분할**하거나, **LOD를 효율적으로 관리**하기 위해서이다. 간단히 말해, 샘플 지점(버텍스)이 $ 2^{n} + 1 $ 개이면, 셀이 나뉘는 간격(폴리곤/타일)은 정확히 $ 2^{n} $ 개로 분할되기 때문에 **계층적(Subdivision) 관리**와 **경계부 봉합**이 쉬워진다.

---

### **1 지형을 $ 2^{n} $ 구역으로 나누기 위한 "버텍스 개수" 설계**

- 버텍스 수가 $ 2^{n} + 1 $ 개이면, 실제 사각형 셀은 가로세로 각각 $ 2^{n} $ 개가 된다.
  - 예: 257x257 = $ 2^{8} + 1 \times 2^{8} + 1 $ -> 실제 지형은 256x256 = $ 2^{8} \times 2^{8} $ 

- 즉, 지형을 256x256, 512x512와 같은 2의 제곱짜리 셀로 딱 맞게 나눌 수 있으므로,
  - **LOD 알고리즘**을 적용할 때 계층적으로 분할(쿼드트리)하기 용이
  - 타일 경계(Seam) 처리도 편리
  - **이진(Quadtree) 방식**으로 지형을 재귀 분할해도 남는 부분이 없이 딱 맞음

---

### **2\. LOD 시스템과의 궁합**

- Unity의 Terrain 시스템은 내부적으로 **다중 해상도(Multi-Resolution) 메시에 기반**해 멀리 있는 지형은 낮은 폴리곤으로, 가까운 지형은 높은 폴리곤으로 렌더링할 수 있다.

- 이때 지형 해상도가 $ 2^{n} + 1 $ 로 설정되어 있으면, LOD 단계를 나눌 때 폴리곤을 2의 제곱 배율로 줄이거나 늘리기 쉽다(256->128->64->...)

---

### **3\. 경계부 정렬과 Seam 최소화**

- 여런 Terrain 타일(또는 Chunk)들을 이어 붙일 때, 만약 각각의 높이 맵이 $ 2^{n} + 1 $ 해상도를 가지고 있으면, "가장자리 경계 점"이 동일한 수만큼 존재하므로 이웃 지형과 이음새(Seam) 없이 잘 이어질 수 있다.

- 예: 가로 길이가 256셀이면, 경계 지점(버텍스)이 257개이므로, 옆 타일과 '하나 겹치는' 형태로 매끄럽게 연결 가능

---

### **4\. 과거 분할 기법(Diamond-Square, Fault Line 등)**

- 옛날 고전적 Heightmap 생성 알고리즘 중 "Diamond-Square" 기법 역시, $ 2^{n} + 1 $  사이즈를 기본으로 사용한다.

- 이 알고리즘들은 지형을 재귀적으로 반 분할해가며 높이를 생성하는데, 그 과정에서 $ 2^{n} + 1 $ 이 계산에 편리하다.

---

### **5\. 결론**

" $ 2^{n} + 1 $ "의 형태는 지형을 **2의 거듭제곱 단위**로 정확히 나눌 수 있기 때문에,
1. **LOD 분할**에 유리하고
2. **경계부(Seam) 처리**가 간단하며
3. **지형 편집 & 렌더링** 시 내부 계산이 깔끔해져서    

게임 엔진(특히 Unity)에서 표준으로 쓰는 방식이다.

즉, 지형의 버텍스 수가 $ 2^{n} + 1 $ 이면, 실제 지형 셀(폴리곤)은 $ 2^{n} $ 개가 되어,
- 계층적 분할
- LOD
- Seamless 타일링    

등을 수월하게 달성할 수 있는 것이다.