---
title: "25.05.02 / 키네마틱스 (Forward Kinematics, Inverse Kinematics)"
excerpt: ""

categories:
  - Programming
  - Game Development
tags:
  - []

toc: true
toc_sticky: true
use_math: true

date: 2025-05-02
last_modified_at: 2025-05-08
---

게임에서 캐릭터가 움직이거나 애니메이션이 재생될 때, 관절이 어떻게 움직이는지를 결정하는 방식을 '키네마틱스(Kinematics)'라고 부른다. 여기에는 크게 **Forward Kinematics(FK)**와 **Inverse Kinematics(IK)** 두 가지 방식이 있다.

---

### **1\. Forward Kinematics (정방향 키네마틱스)**

#### 개념: 
- **각 관절(조인트)의 회전 각도∙변위값**을 기준으로 최종적으로 모델의 특정 지점(End Effector, 예: 손끝, 발끝)이 어디로 이동하는지를 계산하는 방식이다.

#### 동작 방식:
1. 루트 본(Root Bone)에서 시작하여, 부모 본이 움직이면 자식 본이 그 움직임을 이어받는다.
2. 각 관절마다 설정된 변환(회전, 이동)을 순차적으로 적용하여 최종적으로 말단(End Effector)의 위치와 방향을 구한다.

#### 특징:
- 계산 구조가 단순하고 빠르다. (관절 변화를 주면 그대로 결과가 나오므로 순방향으로 직관적)
- **애니메이션 제작**에서 기본적으로 많이 사용된다(키프레임 애니메이션).
- 다만, 만단 부위를 특정 좌표(예: 바닥 위에 손을 올리는 등)에 정확히 고정시키기에는 적합하지 않다. 관절 각도를 바꾸어도 원하는 위치에 정확히 배치하기가 까다롭기 때문이다.

#### 예시: 2D 2-링크 로봇 팔 예시
- 각 링크의 길이를 $ l_1, l_2 $ 라고 하고,
- 링크 1의 회전 각도를 $ \theta_1 $, 링크 2의 회전 각도를 $ \theta_2 $ 라고 하자.
- (0, 0)에서 링크 1이 시작한다고 가정한다.

그렇다면, 두개의 링크를 가진 로봇 팔의 **말단(End Effector)의 좌표** $ (x, y) $ 는 다음과 같이 구할 수 있다.

$ x = l_1 \cos(\theta_1) + l_2 \cos(\theta_1 + \theta_2) $ \\
$ y = l_1 \sin(\theta_1) + l_2 \sin(\theta_1 + \theta_2) $

- 첫 번째 링크(길이 $ l_1 $)가 $ \theta_1 $ 만큼 회전,
- 이어서 두 번째 링크(길이 $ l_2 $) 가 $ \theta_1 + \theta_2 $ 만큼 회전한다고 볼 수 있다.

---

### **2\. Inverse Kinematics (역방향 키네마틱스)**

#### 개념: 
- **말단 부위(End Effector)가 가야할 목표 위치∙방향**을 먼저 지정하고, 그 위치를 만족하기 위해 각 관절의 회전값을 역으로 계산하는 방식이다.

#### 동작 방식:
1. 목표 위치(예: 바닥 위에 손바닥을 정확히 대는 위치)를 설정한다.
2. 역방향으로 "이 위치에 도달하려면 어깨/팔꿈치는 어떤 각도로 움직여야 할까?"와 같은 식으로 각 관절의 회전값을 수학적으로 푼다.

#### 특징:
- 말단 부위를 특정 위치에 자연스럽게 배치하고 싶을 때 매우 유용하다. (예: 손으로 문 손잡이를 잡는 동작, 발을 정확히 바닥에 붙이는 동작)
- 수학적 계산(행렬, 벡터)이 복잡하고, 실시간으로 계산할 때 비교적 비용이 많이 든다.
- 게임 엔진에서 흔히 하체 IK(발이 바닥에 딱 붙게 조정)나 상체 IK(팔이 물체를 잡도록 조정)를 적용할 때 사용된다.\

#### 예시: 2D 2-링크 로봇 팔 예시
- 엔드 이펙터가 목표 위치 $ (x, y) $ 에 도달해야 한다고 하자.
- 이제 **$ \theta_1, \theta_2 $ 를 어떻게 정해야 이 목표 위치를 만족할까**를 계산한다.   

1) $ \theta_2 $ 계산 \\
$
\theta_2
= \pm \cos^{-1} \Biggl( \frac{x^2 + y^2 - l_1^2 - l_2^2}{2\,l_1\,l_2} \Biggr).
$
- $ \pm $ 는 로봇 팔이 굽혀지는 방향에 따라 두 가지 해가 존재할 수 있음을 의미한다.   


2) $ \theta_1 $ 계산 \\
$
\theta_1
= \tan^{-1}(y,\, x) \tan^{-1}\Biggl(\frac{l_2 \sin(\theta_2)}{l_1 + l_2 \cos(\theta_2)}\Biggr).
$
- $ \tan^{-1}(y, x) $ 는 $ (x, y) $ 의 폴라각(방향)을 구하는 식(atan2)이다.
- 뒤쪽 항은 $ \theta_2 $ 가 결정된 상황에서, 남은 링크의 회전 각도를 구하는 과정이다.

---

### 요약

- **Forward Kinematics**: 관절 각도(변환)를 먼저 정하고, 그 결과 말단부가 어디로 가는지 "앞에서 뒤로" 계산.
  - 단순, 빠름, 키프레임 애니메이션 작업에 많이 사용됨.
  - 말단을 특정 위치에 고정하기 어렵다는 단점이 있음.

- **Inverse Kinematics**: 말단 위치(목표)를 정해두고, 그것을 만족하기 위한 관절 각도를 "뒤에서 앞으로" 역계산.
  - 말단을 원하는 곳에 배치하기에 좋고, 현실적인 접지나 상호작용 구현이 가능.
  - 계산이 복잡하고, 실시간 연산에 비용이 더 듦.
