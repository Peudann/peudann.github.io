---
title: "25.05.09 / Texture Splatting"
excerpt: ""

categories:
  - Programming
  - Game Development
tags:
  - []

toc: true
toc_sticky: true

date: 2025-05-09
last_modified_at: 2025-05-12
---

<div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
  <img src="/assets/img/250509_02splatting/01.jpeg" alt="01" style="max-width: 250%;" />
</div>

**Texture Splatting**이란, 보통 **지형(Terrain)**이나 **대형 표면**에 서로 다른 여러 텍스처를 **블렌딩(혼합)**해 자연스럽게 표현하는 기법을 말한다. 단일 텍스처만 반복해서 사용하면 단조롭고 어색해 보이기 쉬운데, 이 기법을 사용하면 **잔디∙흙∙바위∙눈**과 같은 다양한 재질을 하나의 지형에 중첩하여 부드럽게 표현할 수 있다.

---

### **1\. 기본 개념**

1. **여러 텍스처 사용**
  - 예: 잔디, 바위, 흙 등 여러 개의 텍스처를 준비한다.

2. **블렌딩 정보(Splat Map 또는 Weight Map) 사용**
  - "어느 지점에서 어떤 텍스처가 얼마나 비중을 차지하는지"를 나타내는 **마스크(Blend Mask) 또는 Weight Map**을 사용한다.
  - 보통 RGBA 채널을 각각 다른 텍스처의 Weight(혼합 비율)로 할당하여, 한 픽셀마다 텍스처 비율을 달리할 수 있다.

3. **셰이더(Shader)에서 혼합**
  - CPU나 게임 엔진에서 "어느 지형 타일에 어떤 텍스처를 입힐지" 결정한 뒤, GPU에서 셰이더를 통해 실제로 각 픽셀마다 **텍스처를 블렌딩**하여 렌더링한다.

---

### **2\. 왜 사용할까?**

1. **자연스러운 지형 표현**
  - 하나의 텍스처만 무한 반복하면 타일 패턴이 티가 많이 난다. 하지만 여러 텍스처를 섞으면 패턴 반복이 덜 드러나서 더 리얼하게 보인다.

2. **세분화된 지형 구역 관리**
  - 예: 산 정상 부분은 바위 텍스처가 많이, 골짜기나 길은 흙/진흙 텍스처가 많이, 들판은 잔디 텍스처가 많은 식으로 지형 특성을 잘 살릴 수 있다.

3. **효율적인 메모리/렌더링**
  - 옛날 기법인 "대형 텍스처 하나에 모든 지형 디테일을 전부 페인팅"하는 방식은 해상도를 크게 해야만 정밀도가 올라가 메모리 부담이 크다.
  - Texture Splatting은 작은 기본 텍스처들을 **타일링** 형태로 재사용하며, 블렌딩 마스크만 그 지점별 차이를 표현하므로 상대적으로 메모리를 절약할 수 있다.

4. **레벨 디자인 편의성**
  - 엔진 내에서 페인트 툴처럼 브러시로 원하는 지역에 특정 텍스처를 칠하여 Weight 값을 부여할 수 있다.
  - 그래픽 아티스트나 레벨 디자이너가 직관적으로 지형을 꾸밀 수 있다.

---

### **3\. 동작 원리(일반적 파이프라인)**

1. **기본 텍스처들 준비**
  - 예: Grass, Rock, Dirt, Snow 등 여러 개
  - 보통 2D 이미지(알베도 + 노멀 맵 등)

2. **Weight Map(Splat Map) 생성**
  - 지형의 각 픽셀(혹은 버텍스)에 대해 Grass 비중, Rock 비중, Dirt 비중, Snow 비중을 R, G, B, A 값으로 저장
  - 예: R=Grass(0.7), G=Rock(0.2), B=Dirt(0.1), A=Snow(0.0) -> 이 픽셀은 Grass 70%, Rock 20%, Dirt 10% 혼합
  - 엔진에서 자동 계산하거나 디자이너가 브러시로 페인팅할 수도 있음

3. 셰이더에서 텍스처 블렌딩

   - **파이프라인**:  
     1. 현재 픽셀 좌표에 따라 Weight Map의 (R, G, B, A) 값을 읽음  
     2. 4가지 텍스처(Grass, Rock, Dirt, Snow)를 각각 샘플링  
     3. Weight에 따라 lerp로 혼합  
     4. 최종 색상 출력

       ```c
      color = weight.r * GrassColor 
            + weight.g * RockColor 
            + weight.b * DirtColor 
            + weight.a * SnowColor;
       ```

4. **멀티 패스 / 멀티 텍스쳐 최적화**
  - 일부 엔진은 한 번의 드로우 콜(Draw Call)로 여러 텍스처 블렌딩을 수행하기 위해 멀티 텍스처링(Multi-Texturing) 기법을 사용하거나, 더 복잡해지면 어러 패스로 나누어 그릴 수도 있다.
  - 현대 엔진에서는 GPU 셰이더를 통해 한 번에 여러 텍스처를 샘플링하고 Weight Map 값을 혼합하는 것이 일반적이다.

---

### **4\. 확장 기법**

1. **멀티 Splat Map**
  - 하나의 RGBA 채널만으로는 4가지 텍스처 블렌딩이 한계이므로, 2개 이상의 Splat Map을 사용해 더 많은 텍스처를 섞을 수 있다.

2. **PBR(Material) 기반 Splatting**
  - 알베도(기본 색상)뿐만 아니라 노멀 맵, 러프니스, 메탈릭 등 **PBR(Physically Based Rendering)** 특성치도 블렌딩하여 보다 리얼한 지형을 구현한다.

3. **Height Blending**
  - 단순 알파 블렌딩이 아닌, 텍스처 각각의 높이(Height) 정보를 사용해 경계부를 자연스럽게 섞는 기법이다. 바위와 흙이 만나는 부분에 오버랩이 좀 더 부드럽게 표현될 수 있다.

4. **Dynamic Splatting**
  - 게임 플레이 중에 동적으로 텍스처를 바꾸거나 페인트칠 하는 식의 인터랙션(예: 총알이 맞은 자리의 탄흔)을 구현할 수도 있다.

---

### **5\. 요약**

- **Texture Splatting** = 여러 텍스처를 **한 지형 위에 중첩**하여 자연스러운 지형 표현을 하는 기법
- **핵심 요소**
  1. 다양한 베이스 텍스처
  2. 텍스처 비중을 기록한 Weight(Splat) Map
  3. 셰이더 내에서 픽셀 단위로 텍스처 혼합
- **장점**
  - 넓은 지형에 세밀한 디테일을 표현하면서 반복 패턴을 줄임
  - 페인팅 툴로 레벨 디자인이 직관적
  - 메모리와 성능을 어느 정도 절약 가능
- **응용**
  - PBR 텍스처 블렌딩, Height Blending, 다이나믹 페인팅 등


