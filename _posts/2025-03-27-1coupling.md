---
title: "25.03.27 / 결합도(Coupling), 응집도(Cohesion)"
excerpt: ""

categories:
  - Programming
  - C#
tags:
  - []

toc: true
toc_sticky: true

date: 2025-03-27
last_modified_at: 2025-04-29
---

객체 지향 프로그래밍에서 결합도와 응집도는 소프트웨어 설계의 품질을 평가하는 중요한 개념이다. 결합도와 응집도는 시스템을 구성하는 클래스와 모듈(또는 컴포넌트) 간의 관계와 내부 구조를 나타내며, 일반적으로 낮은 결합도와 높은 응집도를 가진 구조가 유지보수성과 확장성이 뛰어나다고 평가받는다.

- 결합도(Coupling)

  - 1\. 결합도의 정의
    - 결합도는 한 모듈(혹은 클래스)이 다른 모듈과 얼마나 밀접하게 연관되어 있는지를 나타내는 척도다.
    - 결합도가 높을수록 하나의 모듈을 변경했을 때 다른 모듈도 영향을 크게 받게 된다.
  - 2\. 결합도 유형
    - 결합도는 일반적으로 아래와 같은 유형에 따라 점진적으로 느슨해진다(안 좋은 쪽에서 좋은 쪽으로 갈 수록).
      - 2-1. 내용 결합(Content Coupling)
        - 한 모듈이 직접 다른 모듈의 내부 구현(변수나 로직)에 접근하여 사용한다면 가장 강한 결합 상태이다.
        - 예를 들어 클래스 A가 클래스 B의 private 멤버에 반직접적으로 접근하거나, 디컴파일해서 직접 수정하는 행위.
      - 2-2. 공유 결합(Common Coupling)
        - 여러 모듈이 전역 변수나 공통 자원을 공유할 때 발생한다.
        - 예를 들어 모든 클래스가 하나의 전역 데이터베이스 인스턴스를 공유해 사용하고, 해당 인스턴스 구조가 변경되면 다수의 클래스가 동시에 영향을 받는 상황.
      - 2-3. 외부 결합(External Coupling)
        - 모듈이 외부 데이터나 하드웨어 디바이스와 직접 상호작용 할 때 발생한다.
        - 예를 들어 전역적으로 사용하는 파일, 네트워크 리소스 등과 직접 연결되어 있어서 바뀌면 영향을 받는 경우.
      - 2-4. 제어 결합(Control Coupling)
        - 한 모듈이 다른 모듈의 흐름(제어)을 결정(플래그, 설정값 등)하여, 그 플래그에 따라 다른 모듈의 내부 로직이 달라지는 경우이다.
      - 2-5. 스탬프 결합(Stamp Coupling)
        - 모듈이 서로 복합 데이터 구조(예: 클래스, 구조체, 레코드)를 전달하면서, 실제로는 필요한 부분만 사용하지만 전체 구조를 공유함으로써 필요 이상의 의존 관계가 생기는 경우이다.
      - 2-6. 데이터 결합(Data Coupling)
        - 모듈 간에 단순한 데이터(매개변수)만 주고받는 상태로, 가장 이상적인 결합 상태에 가깝다.
        - 예를 들어 메소드 간에 필요한 파라미터만 전달하고, 내부 구현을 노출하지 않는 형태.
  - 3\. 결합도를 낮추는 방법 - 3-1. 인터페이스 사용 - 클래스 간 직접적인 의존이 아니라, 인터페이스를 통해 간접 의존하도록 설계한다. - 3-2. 의존성 주입(Dependency Injection) - 필요한 객체를 직접 생성하는 대신, 외부에서 주입받아 사용함으로써 클래스 간 결합을 느슨하게 한다. - 3-3. 캡슐화(Encapsulation) - 클래스 내부 구현을 감추고, 필요한 부분만 공개 인터페이스(메소드, 프로퍼티)로 제공해 외부 의존을 최소화한다. - 3-4. 솔리드 원칙(SOLID) 준수 - 특히, DIP(Dependency Inversion Principle)를 적용해 상위 레벨 모듈이 하웨 레벨 모듈에 직접 의존하지 않도록 한다.
    &nbsp;
    &nbsp;

- 응집도(Cohesion)
  - 1\. 응집도의 정의
    - 응집도는 한 모듈(혹은 클래스) 내부의 구성요소(필드, 메소드 등)가 얼마나 밀접하고 관련성 있는 기능을 수행하는지를 나타내는 척도이다.
    - 응집도가 높을수록 그 모듈의 구성 요소들이 서로 긴밀히 연관되어 있어서, 하나의 책임(Responsibility)에 집중하는 구조이다. 응집도가 낮으면 관련 없는 기능들이 한 모듈에 섞여 있어 유지보수가 어려워진다.
  - 2\. 응집도 유형
    - 응집도 역시 낮은 것(안 좋음)에서 높은 것(좋음) 순으로 분류되는데, 대표적으로 다음과 같은 유형이 있다.
      - 2-1. 우연적 응집(Coincidental Cohesion)
        - 모듈 안의 기능들이 서로 아무런 관련 없이 우연히 모여있는 형태이다.
        - 예를 들어 Utility 클래스라는 이름으로 아무 기능이나 다 때려 넣은 경우.
      - 2-2. 논리적 응집(Logical Cohesion)
        - 비슷한 범주의 작업(예: 파일 처리, 문자열 처리)을 묶어 놓았지만, 실제 내부 기능이 서로 직접적으로 연관되지 않은 경우이다.
      - 2-3. 시간적 응집(Temporal Cohesion)
        - 특정 시점(프로그램 시작 시, 종료 시, 특정 이벤트 발생 시)에 실행되어야 하는 기능들을 한 모듈에 모아놓은 경우이다.
      - 2-4. 절차적 응집(Procedural Cohesion)
        - 작업 순서에 따라 관련된 기능을 모아놓은 경우이다. 한 메소드의 출력이 다른 메소드의 입력이 되는 식으로 순차적으로 흐름이 있는 경우이지만, 본질적으로 한 책임으로 엮여 있지 않을 수도 있다.
      - 2-5. 통신적 응집(Communicational Cohesion)
        - 같은 데이터를 사용하는 기능들이 모여 있는 경우이다.
      - 2-6. 순차적 응집(Sequential Cohesion)
        - 한 작업의 결과가 다음 작업의 입력으로 직접 사용되는 형태이다.
      - 2-7. 기능정 응집(Functional Cohesion)
        - 모듈 내부의 모든 요소가 정말 하나의 목적을 위해 집중적으로 협력하는 이상적인 형태이다.
        - 예를 들어 Math 클래스 내부에 수학 연산과 관련된 기능만 모아두고, 입출력 모두 해당 책임 범위 내에서만 처리.
  - 3\. 응집도를 높이는 방법
    - 3-1. 단일 책임 원칙(SRP) 준수
      - 하나의 클래스가 하나의 책임(기능)에 집중하도록 설계한다.
    - 3-2. 모듈화
      - 큰 기능을 자게 쪼개고, 각각의 기능이 한 가지 역할만 수행하도록 만든다.
    - 3-3. 클래스 및 메소드 이름에 명확한 의도 반영
      - 이름에서 클래스/메소드가 어떤 일을 하는지 명확히 드러나도록 해, 다양한 기능이 섞이지 않도록 유도한다.
    - 3-4. 캡슐화
      - 내부 구현을 명확히 구분하고, 필요한 자료와 메소드가 서로 밀접하게 유기적으로 작동하도록 하여 내부적으로 응집력이 높아지게 한다.

결합도는 모듈끼리의 외부적인 의존 관계를, 응집도는 모듈 내부 구성 요소들의 내부적인 일관성을 뜻한다. 이상적인 설계는 서로 다른 모듈 간에는 의존도를 최소화(낮은 결합도)하고, 모듈 내부 구성 요소들은 하나의 책임에 집중하도록(높은 응집도) 만드는 것이다.

두 개념은 상호 보완적인 관계로, 한쪽을 개선하면 다른 쪽도 자연스럽게 개선되는 경향이 있다. 예를 들어, 클래스가 단일 책임을 갖도록 하여 응집도를 높이면, 클래스 간 주고받는 정보량이 줄어들어 결합도도 낮아진다.

결국 낮은 결합도와 높은 응집도를 만족하는 구조를 지향하면, 코드가 변경에 유연하고 유지보수가 수월해지며 재사용성도 높아진다. 이는 객체 지향 프로그래밍의 SOLID 원칙과도 직결되는 중요한 설계 요소이며, 올바른 아키텍처를 구축하는 핵심 요인이 된다.
